<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Mi Blog{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        html {
            height: 100%;
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #f8fafc; /* Light mode background */
            color: #334155; /* Light mode default text color */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        main {
            flex: 1;
            padding-bottom: 2rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* --- Estilos de Botones Mejorados --- */
        .btn-primary {
            @apply bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl;
			
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
		.btn-primary:hover{box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);}
        .btn-secondary {
            @apply bg-gray-200 text-gray-800 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-all duration-300 transform hover:scale-105 shadow-md hover:shadow-lg;
			
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
		.btn-secondary:hover{box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);}
        .btn-danger {
            @apply bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl;
			
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
		.btn-danger:hover {
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .btn-outline-primary {
            @apply border-2 border-blue-600 text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 hover:text-white transition-all duration-300 transform hover:scale-105 shadow-md hover:shadow-lg;
			
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
		
		.btn-outline-primary:hover {
		@apply transition-all duration-300 transform hover:scale-105 shadow-md hover:shadow-lg
            border-radius: 2rem;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
			border: 2px solid;
        }
        /* --- Fin Estilos de Botones --- */

        .card {
            @apply bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-all duration-300 hover:shadow-xl;
        }
        
        .form-input {
            @apply w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 transition-all duration-300;
			margin-bottom: 0.5rem;
            font-weight: 500;
            border: 1px solid;
			padding: 0.20rem; /* Añadido para asegurar el padding */
        }
        
		#id_email {
            @apply w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 transition-all duration-300;
			margin-bottom: 0.5rem;
            font-weight: 500;
            border: 1px solid;
			padding: 0.20rem; /* Añadido para asegurar el padding */
        }
		
        .form-input:focus {
            @apply shadow-lg;
        }
        
        .messages {
            list-style: none;
            padding: 0;
            margin-bottom: 1rem;
        }
        .messages li {
            padding: 1rem 1.5rem;
            margin-bottom: 0.5rem;
            border-radius: 0.75rem;
            font-weight: 500;
            border-left: 4px solid;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .messages .success {
            background-color: #ecfdf5;
            color: #065f46;
            border-left-color: #10b981;
        }
        .messages .error {
            background-color: #fef2f2;
            color: #991b1b;
            border-left-color: #ef4444;
        }
        .messages .info {
            background-color: #eff6ff;
            color: #1e40af;
            border-left-color: #3b82f6;
        }
        .messages .warning {
            background-color: #fffbeb;
            color: #92400e;
            border-left-color: #f59e0b;
        }

        /* Navbar mejorado */
        .navbar {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
		
        /* Dark mode styles */
        html.dark body {
            background-color: #0f172a;
            color: #e2e8f0;
        }
		
        html.dark .navbar {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
        
        html.dark .btn-primary {
            background-color: #3b82f6;
            color: #fff;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
        html.dark .btn-primary:hover {
            background-color: #2563eb;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        
        html.dark .btn-secondary {
            background-color: #4a5568;
			color: #e2e8f0;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
        html.dark .btn-secondary:hover {
            background-color: #718096;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        html.dark .btn-danger {
            background-color: #ef4444;
            color: #fff;
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
        html.dark .btn-danger:hover {
            background-color: #dc2626;
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }
        html.dark .btn-outline-primary {
            border-color: #3b82f6;
            color: #3b82f6;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
			margin-bottom: 1rem;
			border-radius: 2rem;
			font-weight: 500;
			border: 2px solid;
			padding: 0.75rem 1.5rem; /* Añadido para asegurar el padding */
        }
        html.dark .btn-outline-primary:hover {
            background-color: #3b82f6;
            color: #fff;
        }
        html.dark .card {
            background-color: #1e293b;
            color: #e2e8f0;
            border-color: #334155;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
		
        html.dark .form-input {
            background-color: #1e293b;
            border-color: grey;
            color: #e2e8f0;
			margin-bottom: 0.5rem;
            border-radius: 0.75rem;
            font-weight: 500;
            border: 2px solid;
			padding: 0.20rem; /* Añadido para asegurar el padding */
        }
		
		html.dark #id_email {
		    background-color: #1e293b;
            border-color: grey;
            color: #e2e8f0;
			margin-bottom: 0.5rem;
            border-radius: 0.75rem;
            font-weight: 500;
            border: 2px solid;
			padding: 0.20rem; /* Añadido para asegurar el padding */
		}

        /* Gradient Text */
        .gradient-text {
            background-image: linear-gradient(to right, #3b82f6, #9333ea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent; /* Fallback for browsers that don't support -webkit-text-fill-color */
        }
        
        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        .animate-fade-in-delay {
            animation: fadeIn 0.8s ease-out 0.3s forwards;
            opacity: 0; /* Asegura que no sea visible antes de la animación */
        }

        .animate-fade-in-delay-2 {
            animation: fadeIn 0.8s ease-out 0.6s forwards;
            opacity: 0;
        }

        .animate-slide-up {
            animation: slideUp 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <header class="navbar p-4 shadow-md sticky top-0 z-50">
        <div class="container flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-2xl font-bold text-white flex items-center space-x-2">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13.5m0-13.5C10.834 5.46 9.47 5 8 5c-4 0-5 3-5 5a7 7 0 0013.568 3.568m-4.5-4.5c1.11 0 2.027-.365 2.83-1.124M15 11a3 3 0 11-6 0 3 3 0 016 0zm-6 0v2m0 0H9m-6.538 4.634A9 9 0 0112 18.255"></path>
                </svg>
                <span>Mi Blog</span>
            </a>
            <nav class="flex items-center space-x-6">
                <a href="{% url 'blog:post_list' %}" class="text-white hover:text-blue-200 transition duration-300 font-medium">Blog</a>
                {% if user.is_authenticated %}
                    <div class="relative group">
                        <a href="#" class="text-white hover:text-blue-200 transition duration-300 font-medium flex items-center">
                            {{ user.username }}
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </a>

                        <div class="absolute right-0 mt-2 w-45 bg-white dark:bg-gray-700 rounded-md shadow-lg py-1 z-20 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 translate-y-2 transition-all duration-300 ease-out transform pointer-events-none group-hover:pointer-events-auto">
                             
						{% if user.is_superuser or user.profile.is_editor %}
							<a href="{% url 'blog:post_create' %}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600">Crear Post</a>
						{% endif %}
						{% if user.is_staff %}
							<a href="{% url 'admin:index' %}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600">Administración</a>
						{% endif %}
						
						<form action="{% url 'logout' %}" method="post" class="w-full">
							{% csrf_token %}
							<button type="submit" class="block w-full text-left px-4 py-2 text-red-800 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-700 hover:text-red-700 dark:hover:text-red-300 focus:outline-none focus:bg-red-100 dark:focus:bg-red-700">
							Cerrar Sesión
						</button>
						</form>
					</div>
					
                    </div>
                {% else %}
                    <a href="{% url 'login' %}" class="btn-secondary-inverted px-4 py-2 rounded-lg font-semibold text-white border-2 border-white hover:bg-white hover:text-blue-600 transition duration-300">Iniciar Sesión</a>
                    <a href="{% url 'register' %}" class="btn-primary-inverted px-4 py-2 rounded-lg font-semibold bg-white text-blue-600 hover:bg-blue-100 transition duration-300">Registrarse</a>
                {% endif %}
                <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                    <svg id="sun-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    <svg id="moon-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                </button>
            </nav>
        </div>
		
    </header>

    <main class="container py-8">
        {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gray-800 dark:bg-gray-900 text-white py-6 mt-auto shadow-inner">
        <div class="container text-center text-gray-400">
            <p><a href="https://github.com/EzequielEdOjeda" class="hover:text-blue-400 transition-colors duration-300">Por @EzequielEdOjeda.</a> &copy;{% now "Y" %} </p>
        </div>
    </footer>

    {% block extra_scripts %}{% endblock %}
	
    <script>
        const themeToggle = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        function setTheme(theme) {
            if (theme === 'dark') {
                htmlElement.classList.add('dark');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            } else {
                htmlElement.classList.remove('dark');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }
            localStorage.setItem('theme', theme);
        }

        // Verificar tema guardado o preferencia del sistema
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (savedTheme) {
            setTheme(savedTheme);
        } else if (prefersDark) {
            setTheme('dark');
        } else {
            setTheme('light');
        }

        // Alternar tema al hacer clic
        themeToggle.addEventListener('click', () => {
            if (htmlElement.classList.contains('dark')) {
                setTheme('light');
            } else {
                setTheme('dark');
            }
        });

        // Smooth scroll para enlaces ancla
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>